{% set cat = article.category %}
{% set cat_colors = {
  "vulnerabilities":  "#c0392b",
  "malware":          "#d35400",
  "appsec":           "#1a56db",
  "cloud_security":   "#0891b2",
  "compliance":       "#057a55",
  "privacy":          "#4b5563",
  "threat_intel":     "#7c3aed",
  "ai_security":      "#6610f2"
} %}
{% set cat_color = cat_colors.get(cat, "#4f46e5") %}
{% set cat_label = cat | replace("_", " ") | upper %}

<div class="tinder-card" id="tinder-card-{{ article.id }}">

  <!-- Image area -->
  <div class="tinder-card-img-wrap">
    {% if article.image_url %}
      <img
        src="{{ article.image_url }}"
        alt="{{ article.title }}"
        class="tinder-card-img"
        onerror="this.style.display='none';this.nextElementSibling.style.display='flex'"
      >
      <div class="tinder-img-gradient" style="display:none;background:linear-gradient(135deg,{{ cat_color }}cc 0%,{{ cat_color }}44 100%)">
        <span class="tinder-img-cat-label">{{ cat_label }}</span>
      </div>
    {% else %}
      <div class="tinder-img-gradient" style="background:linear-gradient(135deg,{{ cat_color }}cc 0%,{{ cat_color }}44 100%)">
        <span class="tinder-img-cat-label">{{ cat_label }}</span>
      </div>
    {% endif %}

    <span class="tinder-cat-badge" style="background:{{ cat_color }}cc">
      {{ cat | replace("_", " ") | title }}
    </span>
    {% if article.is_featured %}
      <span class="tinder-featured-badge">&#11088; Featured</span>
    {% endif %}
  </div>

  <!-- Content area -->
  <div class="tinder-card-body">
    <h5 class="tinder-title">
      {{ article.title }}
    </h5>

    <div class="tinder-meta">
      <span class="fw-semibold">{{ article.source_name }}</span>
      {% if article.published_at %}
        <span> &middot; {{ article.published_at | time_ago }}</span>
      {% endif %}
    </div>

    {% if article.summary_status == "done" and article.summary %}
      <div class="tinder-summary-wrap">
        <p class="tinder-summary tinder-summary-collapsed" id="ts-{{ article.id }}">{{ article.summary }}</p>
        <button class="read-more-btn" id="rm-{{ article.id }}" onclick="toggleReadMore('{{ article.id }}')">â€¦read more</button>
      </div>
    {% elif article.summary_status in ["pending", "processing"] %}
      <p class="tinder-summary fst-italic">
        <span class="spinner-border spinner-border-sm me-1" style="width:.8rem;height:.8rem"></span>
        AI summary in progress...
      </p>
    {% else %}
      <p class="tinder-summary fst-italic" style="color:#f85149;font-size:.82rem">Summary unavailable</p>
    {% endif %}

    <a
      href="{{ article.url }}"
      target="_blank"
      rel="noopener noreferrer"
      class="tinder-read-btn"
    >
      Read original &rarr;
    </a>
  </div>

</div>
